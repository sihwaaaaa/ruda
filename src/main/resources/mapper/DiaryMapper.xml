<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="co.poetrypainting.ruda.mapper.DiaryMapper">
    <insert id="insert">
        insert into tbl_diary (weather,emotion,keyword,content,colorNo,memberNo,ownerDate)
        values(#{weather},#{emotion},#{keyword},#{content},#{colorNo},1,#{ownerDate})
    </insert>
    <select id="selectColorDto" resultType="co.poetrypainting.ruda.domain.ColorDto">
		select * from tbl_color where colorNo > 0
	</select>
    <select id="selectByPrimaryKey" resultType="co.poetrypainting.ruda.domain.DiaryVo">
		select * from tbl_diary where diaryNo = #{diaryNo}
	</select>
    <select id="getColorCode">
		select colorCode from tbl_color where colorNo = #{getColorNo}
	</select>
    <select id="selectDiaryList" resultType="co.poetrypainting.ruda.domain.DiaryVo">
		select * from tbl_diary where diaryNo > 0
	</select>
<select id="searchDiaryList" resultType="co.poetrypainting.ruda.domain.DiaryVo">
    select * from tbl_diary where keyword like CONCAT('%', #{keyword}, '%')
</select>

<select id="countSearchResults" resultType="int">
    select count(*) from tbl_diary where keyword like CONCAT('%', #{keyword}, '%')
</select>
<select id="searchDiaryListLatest" resultType="co.poetrypainting.ruda.domain.DiaryVo" parameterType="map">
    SELECT *
    FROM tbl_diary
    WHERE keyword LIKE CONCAT('%', #{keyword}, '%')
    ORDER BY ownerDate DESC
    LIMIT #{offset}, #{limit}
</select>

<select id="searchDiaryListOldest" resultType="co.poetrypainting.ruda.domain.DiaryVo" parameterType="map">
    SELECT *
    FROM tbl_diary
    WHERE keyword LIKE CONCAT('%', #{keyword}, '%')
    ORDER BY ownerDate ASC
    LIMIT #{offset}, #{limit}
</select>

<select id="countSearchDiary" resultType="int" parameterType="String">
    SELECT COUNT(*)
    FROM tbl_diary
    WHERE keyword LIKE CONCAT('%', #{keyword}, '%')
</select>

</mapper>